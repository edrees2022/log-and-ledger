# نظام الأصول الثابتة (Fixed Assets System)

## نظرة عامة
نظام متكامل لإدارة الأصول الثابتة، تتبع قيمتها، وحساب الإهلاك تلقائياً.

## الميزات المنفذة

### 1. سجل الأصول (Asset Register)
- تخزين تفاصيل الأصول (الاسم، الكود، تاريخ الشراء، التكلفة).
- تحديد الحسابات المرتبطة (حساب الأصل، مجمع الإهلاك، مصروف الإهلاك).
- تتبع الحالة (نشط، مستبعد، مهلك بالكامل).

### 2. حساب الإهلاك (Depreciation Calculation)
- دعم طرق الإهلاك:
  - **القسط الثابت (Straight Line)**: (التكلفة - الخردة) / العمر الإنتاجي.
  - **القسط المتناقص (Declining Balance)**: (القيمة الدفترية * المعدل).
- حساب دقيق للأشهر (يدعم الإهلاك الشهري).

### 3. ترحيل الإهلاك (Posting Depreciation)
- إنشاء قيود يومية تلقائية عند ترحيل الإهلاك.
  - **من ح/** مصروف الإهلاك
  - **إلى ح/** مجمع الإهلاك
- تحديث قيمة مجمع الإهلاك في سجل الأصل.
- منع ترحيل الإهلاك إذا تم الوصول للقيمة القابلة للإهلاك.

### 4. الهيكلية البرمجية

#### جداول قاعدة البيانات
- `fixed_assets`: سجل الأصول الرئيسي.
- `asset_depreciation_entries`: سجل تاريخي لعمليات الإهلاك المرحلة.

#### الملفات
- `server/utils/fixedAssets.ts`: منطق الحساب والترحيل.
- `server/routes/fixedAssets.ts`: واجهة برمجة التطبيقات (API).

### 5. API Endpoints

- **GET /api/fixed-assets**: عرض قائمة الأصول.
- **POST /api/fixed-assets**: إضافة أصل جديد.
- **POST /api/fixed-assets/:id/preview-depreciation**: معاينة حساب الإهلاك لتاريخ معين.
- **POST /api/fixed-assets/:id/depreciate**: ترحيل الإهلاك (ينشئ قيد يومية).
- **GET /api/fixed-assets/:id/history**: عرض سجل الإهلاك للأصل.

## الخطوات التالية
- إضافة تقرير "جدول الأصول الثابتة" (Fixed Asset Schedule).
- دعم بيع أو استبعاد الأصول (Disposal) مع حساب الربح/الخسارة الرأسمالية.
